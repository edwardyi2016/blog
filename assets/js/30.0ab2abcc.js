(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{244:function(t,e,s){"use strict";s.r(e);var i=s(0),n=Object(i.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("p",[t._v("随着DevOps的日趋成熟，CI/CD的概念已经慢慢为广大开发运维人员所熟知和认同，本文记录了GitHub结合Jenkins自动构建和部署静态页面的方法，并从中窥见CI/CD之一二，同时也是做一个备忘记录。")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),s("p",[t._v("填写源码的git地址，用于下载源码到jenkins的工作空间，以便后续进行构建操作。")]),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/YupaiTS/yupaits-work/settings/hooks",target:"_blank",rel:"noopener noreferrer"}},[t._v("进入GitHub的相应项目中配置webhook"),s("OutboundLink")],1),t._v("，webhook的"),s("code",[t._v("Payload URL")]),t._v("填写格式为"),s("code",[t._v("http://jenkins所在的domain或者ip:port/github-webhook/")]),t._v("。完成配置后，github接收特定的事件之后会触发请求该url。jenkins接收到请求之后会触发任务执行构建。")]),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"使用github和jenkins自动构建并部署静态页面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用github和jenkins自动构建并部署静态页面","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用GitHub和Jenkins自动构建并部署静态页面")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"创建任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建任务","aria-hidden":"true"}},[this._v("#")]),this._v(" 创建任务")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("创建任务时选择"),e("strong",[this._v("构建一个自由风格的软件项目")]),this._v("。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"/images/%E4%BD%BF%E7%94%A8GitHub%E5%92%8CJenkins%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%B9%B6%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2/jenkins%E5%88%9B%E5%BB%BA%E4%BB%BB%E5%8A%A1.png",alt:"jenkins创建任务"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"配置jenkins任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置jenkins任务","aria-hidden":"true"}},[this._v("#")]),this._v(" 配置Jenkins任务")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"general"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#general","aria-hidden":"true"}},[this._v("#")]),this._v(" General")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"/images/%E4%BD%BF%E7%94%A8GitHub%E5%92%8CJenkins%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%B9%B6%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2/%E4%BB%BB%E5%8A%A1%E9%85%8D%E7%BD%AE-General.png",alt:"任务配置-General"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"源码管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#源码管理","aria-hidden":"true"}},[this._v("#")]),this._v(" 源码管理")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"/images/%E4%BD%BF%E7%94%A8GitHub%E5%92%8CJenkins%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%B9%B6%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2/%E4%BB%BB%E5%8A%A1%E9%85%8D%E7%BD%AE-%E6%BA%90%E7%A0%81%E7%AE%A1%E7%90%86.png",alt:"任务配置-源码管理"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"构建触发器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建触发器","aria-hidden":"true"}},[this._v("#")]),this._v(" 构建触发器")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"/images/%E4%BD%BF%E7%94%A8GitHub%E5%92%8CJenkins%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%B9%B6%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2/%E4%BB%BB%E5%8A%A1%E9%85%8D%E7%BD%AE-%E6%9E%84%E5%BB%BA%E8%A7%A6%E5%8F%91%E5%99%A8.png",alt:"任务配置-构建触发器"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"构建环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建环境","aria-hidden":"true"}},[this._v("#")]),this._v(" 构建环境")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"/images/%E4%BD%BF%E7%94%A8GitHub%E5%92%8CJenkins%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%B9%B6%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2/%E4%BB%BB%E5%8A%A1%E9%85%8D%E7%BD%AE-%E6%9E%84%E5%BB%BA%E7%8E%AF%E5%A2%83.png",alt:"任务配置-构建环境"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("在"),e("code",[this._v("Console Output")]),this._v("中加入时间戳，将"),e("code",[this._v("nodejs")]),this._v(" 和 "),e("code",[this._v("npm")]),this._v("命令加入PATH，方便进行全局执行。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"构建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建","aria-hidden":"true"}},[this._v("#")]),this._v(" 构建")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"/images/%E4%BD%BF%E7%94%A8GitHub%E5%92%8CJenkins%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%B9%B6%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2/%E4%BB%BB%E5%8A%A1%E9%85%8D%E7%BD%AE-%E6%9E%84%E5%BB%BA.png",alt:"任务配置-构建"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("首先执行"),e("code",[this._v("npm install")]),this._v("安装依赖包，再执行"),e("code",[this._v("npm run build")]),this._v("进行构建。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("YupaitsWork.sh")]),this._v("脚本用于将构建生成的页面覆盖掉nginx的静态页面，实现自动更新nginx主页的效果，其内容如下：")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf /var/www/html/**\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" -rf /var/lib/jenkins/workspace/YupaitsWork/dist/** /var/www/html\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("需要注意的是，默认的jenkins用户是没有"),e("code",[this._v("/var/www/html")]),this._v("目录的操作操作权限的，需要使用"),e("code",[this._v("chown -R jenkins:jenkins /var/www/html")]),this._v("更改该目录的所有者为jenkins用户。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"构建后操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建后操作","aria-hidden":"true"}},[this._v("#")]),this._v(" 构建后操作")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"/images/%E4%BD%BF%E7%94%A8GitHub%E5%92%8CJenkins%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%B9%B6%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2/%E4%BB%BB%E5%8A%A1%E9%85%8D%E7%BD%AE-%E6%9E%84%E5%BB%BA%E5%90%8E%E6%93%8D%E4%BD%9C.png",alt:"任务配置-构建后操作"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("将构建后的"),e("code",[this._v("dist")]),this._v("文件夹内容进行归档。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"执行任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#执行任务","aria-hidden":"true"}},[this._v("#")]),this._v(" 执行任务")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("完成任务的创建和配置之后，进入任务页面点击"),e("strong",[this._v("立即构建")]),this._v("即可完成nginx主页的构建和覆盖部署。当然也可以通过push代码实现自动构建和部署。")])}],!1,null,null,null);e.default=n.exports}}]);